<section class="section-upload-photo">
    <section class="top">
        <!-- <div *ngIf="payment?.photo === null" class="div-empty-album">
            <mat-error>Your album is empty. You may upload a photo.</mat-error>
        </div> -->
        <ng-container *ngIf="payment?.photo; else noPhoto">
            <div class="gallery">
                <div class="photos">
                    <img [ngSrc]="photoUrl + payment?.photo?.url_256" width="265" height="265"
                        [alt]="payment?.method + ' photo'" priority />

                    <div class="buttons">
                        <button mat-stroked-button color="primary" disabled>انتخاب عکس</button>
                        <button (click)="deletePhotoComp(payment!.photo!.url_165!)" mat-mini-fab color="warn">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </div>
                </div>
            </div>
        </ng-container>

        <ng-template #noPhoto>
            <div class="div-empty-album">
                <mat-error>Your album is empty. You may upload a photo.</mat-error>
            </div>
        </ng-template>

        @if(loggedInUserSig && loggedInUserSig()?.roles?.includes('manager')) {
        <div class="upload-photo-area">
            <mat-card ng2FileDrop (fileOver)="fileOverBase($event)" (click)="fileInput.click()" [uploader]="uploader"
                [ngClass]="{
                     'nv-file-not-over': !hasBaseDropZoneOver,
                     'nv-file-over': hasBaseDropZoneOver
                  }">

                <mat-card-header>
                    <mat-card-title>اضافه کردن عکس</mat-card-title>
                    <mat-card-subtitle>کلیک کنید یا دراپ کنید</mat-card-subtitle>
                </mat-card-header>

                <mat-card-content>
                    <mat-icon>cloud_upload</mat-icon>
                </mat-card-content>

                <mat-card-actions>
                    <button mat-raised-button type="button">انتخاب عکس</button>
                    <input #fileInput type="file" multiple ng2FileSelect [uploader]="uploader" />
                </mat-card-actions>

            </mat-card>
        </div>
        }
        <!-- <div class="gallery" *ngIf="payment?.photo as photo">
            <div class="photos">
                <img [ngSrc]="photoUrl + photo.url_256" width="265" height="265" [alt]="payment?.method + ' photo'"
                    priority />
                <div class="buttons">
                    <button mat-stroked-button color="primary" [disabled]="true">
                        انتخاب عکس
                    </button>
                    <button (click)="deletePhotoComp(photo.url_165)" mat-mini-fab color="warn">
                        <mat-icon>delete</mat-icon>
                    </button>
                </div>
            </div>

            @if(loggedInUserSig && loggedInUserSig()) {
            @if(loggedInUserSig()?.roles?.includes('manager')) {
            <div class="upload-photo-area">
                <mat-card ng2FileDrop (fileOver)="fileOverBase($event)" (click)="fileInput.click()"
                    [uploader]="uploader" [ngClass]="{
                                'nv-file-not-over': !hasBaseDropZoneOver,
                                'nv-file-over': hasBaseDropZoneOver
                                }">

                    <mat-card-header>
                        <mat-card-title>اضافه کردن عکس</mat-card-title>
                        <mat-card-subtitle>کلیک کنید یا دراپ کنید</mat-card-subtitle>
                    </mat-card-header>

                    <mat-card-content>
                        <mat-icon>cloud_upload</mat-icon>
                    </mat-card-content>

                    <mat-card-actions>
                        <button type="button" mat-raised-button>انتخاب عکس</button>
                        <input multiple type="file" #fileInput ng2FileSelect [uploader]="uploader" id="file">
                    </mat-card-actions>
                </mat-card>
            </div>
            }
            }
        </div> -->
    </section>

    @if (uploader && uploader.queue && uploader.queue.length) {
    <section class="queue">
        <h2>Upload Queue</h2>
        <p>Queue length: {{ uploader.queue.length }}</p>

        <div class="photos-queue">
            <div>
                <strong>Name</strong>
                <strong>Size</strong>
            </div>
            @for (item of uploader.queue; track $index) {
            <div>
                <p>{{ item?.file?.name }}</p>
                @if (uploader.options.isHTML5) {
                <p nowrap> {{ item?.file?.size/1024/1024 | number:'.2' }} MB</p>
                }
            </div>
            }
        </div>

        <div class="process">
            <div>
                Queue progress:
                <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': uploader.progress + '%' }">
                </div>
            </div>
            <div class="buttons">
                <button mat-raised-button color="primary" type="button" (click)="uploader.uploadAll()"
                    [disabled]="!uploader.getNotUploadedItems().length">
                    <mat-icon>upload</mat-icon> Upload all
                </button>
                <button mat-raised-button color="accent" type="button" (click)="uploader.cancelAll()"
                    [disabled]="!uploader.isUploading">
                    <mat-icon>cancel</mat-icon> Cancel all
                </button>
                <button mat-raised-button color="warn" type="button" (click)="uploader.clearQueue()"
                    [disabled]="!uploader.queue.length">
                    <mat-icon>delete</mat-icon> Remove all
                </button>
            </div>
        </div>
    </section>
    }
</section>